
# ArgoCD CLI: Installation, Configuration, and Usage

The ArgoCD CLI is a powerful tool for interacting with the ArgoCD server, enabling users to manage applications, repositories, and clusters efficiently. Below is detailed content for each subtopic: **Installation and Configuration**, **Basic Command Structure**, and **Connection to the ArgoCD Server**.

---

## **Installation and Configuration**

The ArgoCD CLI can be installed on Linux, macOS, and Windows systems. It provides faster and more precise control compared to the UI, making it ideal for automation and scripting.

**Installation Steps**:
1. **Linux**:

   Download the latest version:
     ```bash
     curl -sSL -o argocd-linux-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64
     sudo install -m 555 argocd-linux-amd64 /usr/local/bin/argocd
     rm argocd-linux-amd64
     ```
2. **macOS**:

   Install via Homebrew:
     ```bash
     brew install argocd
     ```

   Alternatively, download using `curl`:
     ```bash
     curl -sSL -o argocd-darwin-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-darwin-amd64
     sudo install -m 555 argocd-darwin-amd64 /usr/local/bin/argocd
     rm argocd-darwin-amd64
     ```

3. **Windows**:

    > This can take very long if executed from within VSCode PowerShell - ensure to run this from a new session in Windows Terminal

   Download using PowerShell:
     ```powershell
     $version = (Invoke-RestMethod https://api.github.com/repos/argoproj/argo-cd/releases/latest).tag_name
     $url = "https://github.com/argoproj/argo-cd/releases/download/" + $version + "/argocd-windows-amd64.exe"
     Invoke-WebRequest -Uri $url -OutFile $env:HOME\workspace\argocd.exe
     [Environment]::SetEnvironmentVariable("Path", "$env:Path;$env:HOME\workspace", "User")
     $env:Path = [System.Environment]::GetEnvironmentVariable("Path", "User")
     ```

**Configuration**:
- Ensure the CLI is added to your system's `PATH` variable.
- Verify installation by running:
  ```bash
  argocd version
  ```

---

## **Connection to ArgoCD Server**

To use the CLI effectively, you must connect it to the ArgoCD server running in your Kubernetes cluster. This involves logging into the server using credentials.

**Steps to Connect**:
1. Log in using the CLI:
   ```bash
   argocd login argocd.localhost:80 --insecure --username admin
   ```
1. Try again to verify ArgoCD Server version:
   ```bash
   argocd version
   ```
1. Change the default admin password for security:
   ```bash
   argocd account update-password
   ```

Once connected, you can manage applications, repositories, and clusters directly from the CLI.

---

## **Basic Command Structure**

The ArgoCD CLI follows a structured command hierarchy to perform various operations. Each command consists of a primary action (e.g., `app`, `repo`, `cluster`) followed by subcommands.

**Common Commands**:
1. **Application Management**:
   - Create an application:
     ```bash
     argocd app create <app-name> --repo <repo-url> --path <path> --dest-server <k8s-api-server> --dest-namespace <namespace>
     ```
   - Sync an application:
     ```bash
     argocd app sync <app-name>
     ```
   - View application status:
     ```bash
     argocd app get <app-name>
     ```
2. **Repository Management**:

   Add a repository:
     ```bash
     argocd repo add <repo-url> --username <username> --password <password>
     ```
3. **Cluster Management**:

   Add a Kubernetes cluster:
     ```bash
     argocd cluster add <cluster-context>
     ```
## Configuration

- For CICD integrations or shell scripting in general it might be useful to provide configuration via environment variables.
- Note the documetation: https://argo-cd.readthedocs.io/en/stable/user-guide/environment-variables/
- During this course, due to the exposure via insecure HTTP, consider setting the following:
  ```bash
  # Bash
  export ARGOCD_SERVER="argocd.localhost"
  export ARGOCD_OPTS="--grpc-web"
  ```
  ```powershell
  # PowerShell
  $env:ARGOCD_SERVER="argocd.localhost"
  $env:ARGOCD_OPTS="--grpc-web"
  ```
